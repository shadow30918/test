var RuleTabNumber=6;var siteName=location.href.split("/").filter(function(a){return a.trim().length>0}).pop();var pageName=(window.location.pathname.split("/").pop()==="")?"index":window.location.pathname.split("/").pop().split(".").shift();var windowWidth=0,windowHeight=0;var isMobile=(navigator.userAgent.match(/Android|iPhone|iPad/i)===null)?false:true;var reHttp=/^http/i;var eventCode="";var home,rule,login,processes,product,winner,faq,extra1,extra2,rule_title;var i,j;$(function(){if(!isMobile){window.location.href="../"}else{getWindowSize();$("body").attr("page",pageName);viewPort(1200);$.post("../func.php",{func:"getEvent"},function(b){if(b.event.length===1){$("#Mask").hide();eventCode=b.eventcode;$("#Header #Menu").empty().append("<ul>");for(var a=0;a<b.event[0].menu.length;a++){if(b.event[0].menu[a].show==="1"){if(b.event[0].menu[a].title==="product"||b.event[0].menu[a].title==="extra2"){$("#Header .container #Menu ul").append('<li data-window="'+b.event[0].menu[a].window+'" data-link="'+b.event[0].menu[a].url+'"><span>'+b.event[0].menu[a].name+"</span></li>")}else{$("#Header .container #Menu ul").append('<li data-link="'+b.event[0].menu[a].title+'"><span>'+b.event[0].menu[a].name+"</span></li>")}switch(b.event[0].menu[a].main){case"home":home=a;break;case"rule":rule=a;break;case"login":login=a;break;case"process":processes=a;break;case"product":product=a;break;case"winner":winner=a;break;case"faq":faq=a;break;case"extra1":extra1=a;break;case"extra2":extra2=a;break}}}$("#Header .container #Menu ul").append('<li data-link="https://www.facebook.com/LGTaiwan/"><span>LG粉絲團</span></li>');$("#Header #Menu li").on("click",function(){if($(this).is(":last-child")){GEvent("Menu-FB");window.open($(this).data("link"),"_blank")}else{GEvent("Menu-"+$(this).text());if($(this).data("link").match(reHttp)){if($(this).data("window")==="1"){window.open($(this).data("link"),"_blank")}else{window.open($(this).data("link"),"_self")}}else{switch($(this).data("link")){case"login":if($("#Header .container #Menu li:nth-child(3) .subMenu").hasClass("show")){$("#Header .container #Menu li:nth-child(3) .subMenu").removeClass("show").stop().fadeOut(100)}else{$("#Header .container #Menu li:nth-child(3) .subMenu").addClass("show").stop().fadeIn(800)}break;case"process":window.location.href=$(this).data("link")+".html";break;case"winner":if(toNumber(b.event[0].menu[winner].show)===1){if(!(b.event[0].menu[winner].msg==="")){alert(b.event[0].menu[winner].msg)}else{window.location.href=$(this).data("link")+".html"}}break;default:if($(this).data("link").length>0){window.location.href=$(this).data("link")+".html"}break}}}});if(pageName==="index"){$("#Content .container #EventImg").empty();$("#Content .container #EventImg").append('<img src="../../../img/'+b.event[0].mobile_img+'" />');$("#Content .container #BU_Rule ").on("click",function(){GEvent("Index:rule");window.location.href="rule.html"})}if(pageName==="rule"||pageName==="winner"){$.post("../func.php",{func:"getPage",type:pageName},function(d){var e=d.info;$("#Content .container #SubMenu").empty();$.each(e,function(f,g){if(pageName==="rule"){switch(g.title){case"新品":rule_title="new";break;case"電視":rule_title="tv";break;case"冰箱":rule_title="ref";break;case"洗衣機 / 其它":rule_title="other";break;case"買就送":rule_title="gift";break;case"買再登錄抽":rule_title="lottery";break}$("#Content .container #SubMenu").append('<li class="bu unselect" style="background-color:'+g.color+'" data-title="'+rule_title+'" data-img="'+g.mobile_img+'"><p>'+g.title+"</p></li>")}else{$("#Content .container #SubMenu").append('<li class="bu unselect" style="background-color:'+g.color+'" data-img="'+g.mobile_img+'"><p>'+g.title+"</p></li>")}});$("#Content .container #SubMenu li, #Content .container #SubMenu li p").css({width:Math.floor($(".container").width()/((e.length>RuleTabNumber)?RuleTabNumber:e.length)-1)});$("#Content .container #SubMenu li:last-child").css({"margin-right":"0",width:($("#Content .container #SubMenu li:last-child").width()+1)+"px"});if(e.length>RuleTabNumber){for(i=1;i<Math.ceil(e.length/RuleTabNumber);i++){$("<br/>").insertAfter("#Content .container #SubMenu li:nth-child("+(e.length-RuleTabNumber*i)+")")}}else{$("#Content .container #SubMenu li").css("margin-bottom","-2px")}$("#Content .container #SubMenu li:first-child").removeClass("unselect").addClass("select");$("#Content .container #Img").empty();$("#Content .container #Img").append('<img src="../../../img/'+$("#Content .container #SubMenu li:first-child").data("img")+'"/>');if(toNumber($("#Content .container #Link").data("page"))===5){$("#Content .container #Link").addClass("show");$("#Content .container #Link #Link_4").on("click",function(){$("#remind").show();remindShow()})}$("#Content .container #SubMenu li").on("mouseenter mouseleave click ",function(f){switch(f.type){case"mouseenter":if(!$(this).hasClass("select")){$(this).removeClass("unselect")}break;case"mouseleave":if(!$(this).hasClass("select")){$(this).addClass("unselect")}break;case"click":$("#Content .container #SubMenu li").removeClass("select").addClass("unselect");$(this).removeClass("unselect").addClass("select");$("#Content .container #Img").empty();$("#Content .container #Img").append('<img src="../../../img/'+$(this).data("img")+'"/>');$("#Content .container #Link").removeClass("show");$("#Content .container #Link[data-page="+$(this).index()+"]").addClass("show");GEvent("Tab-"+$(this).text());break}});if(getUrlParam("spec")){var c=getUrlParam("spec");$("#Content .container #SubMenu li").removeClass("select").addClass("unselect");$('#Content .container #SubMenu li[data-title="'+c+'"]').removeClass("unselect").addClass("select");$("#Content .container #Img").empty();$("#Content .container #Img").append('<img src="../../../img/'+$('#Content .container #SubMenu li[data-title="'+c+'"]').data("img")+'"/>');if(toNumber($("#Content .container #Link").data("page"))===toNumber($('#Content .container #SubMenu li[data-title="'+c+'"]').index())){$("#Content .container #Link").addClass("show")}else{$("#Content .container #Link").removeClass("show")}}},"json")}if(pageName==="faq"||pageName==="fbcheckin"){$.post("../func.php",{func:"getPage",type:pageName},function(c){$("#Content .container #Img").empty();$("#Content .container #Img").append('<img src="../../../img/'+c.info[0].mobile_img+'"/>');if(pageName==="fbcheckin"){$("#Content .container #BU_Login_rule").on("click",function(){window.open("https://www.facebook.com/LGTaiwan/posts/1252733401406491")})}},"json")}$("#Header .container #Menu li:nth-child(3)").append('<div class="subMenu"><span>官網登錄</span><span>窄版冰箱組合送登錄</span></div>');$("#Header .container #Menu li:nth-child(3) .subMenu span").on("click",function(){if($(this).index()===0){GEvent("Submenu:www.lg.com/tw/support/product-registration");window.open("http://www.lg.com/tw/support/product-registration","_blank")}else{GEvent("Menu:Submenu:login");window.location.href="login.html"}})}else{window.location.href="/"}},"json");$("#Header #Menu li[data-link="+pageName+"]").addClass("select");$("#Header #Logo").on("click",function(){GEvent("Logo");window.open("http://www.lg.com/tw","_blank")});$("#Header #NavIcon").on("click",function(){if($("#Header").hasClass("open")){$("html,body").css("overflow","auto");$("#Header").removeClass("open")}else{$("html,body").css("overflow","hidden");$("#Header").addClass("open")}});if(($(window).height()-$("#Header").height())>$("#Menu ul").actual("height")){$("#Header #Menu ul li span").css("height","6rem")}}});function viewPort(d){var b=screen.width;var c=b/d;var a=document.querySelector('meta[name="viewport"]');if(c>1.4){a.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=yes")}else{if(c>1){a.setAttribute("content","width="+d+", initial-scale="+c+", minimum-scale="+c+", maximum-scale="+c+", user-scalable=yes")}else{a.setAttribute("content","width=device-width, initial-scale="+c+", minimum-scale="+c+", maximum-scale="+c+", user-scalable=yes")}}}function getWindowSize(){windowWidth=$(window).width();windowHeight=$(window).height()}function remindShow(){$("#remind #popup #scollInfo").jScrollPane();$("#remind").show();$("#remind #popup #scollInfo #scroll_Close").on("click",function(){$("#remind").hide()})}function toNumber(a){return +a}function RedirNonHttps(){if(location.href.indexOf("https://")==-1){location.href=location.href.replace("http://","https://")}}function getUrlParam(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)");var c=window.location.search.substr(1).match(b);if(c!==null){return unescape(c[2])}return null}function GEvent(b){var a="【"+eventCode+"】("+pageName+") ";console.log(a+b);ga("send","event","button","click",a+b)};